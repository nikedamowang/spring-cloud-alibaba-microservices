# Sentinel ç†”æ–­é™çº§é›†æˆå®ŒæˆæŠ¥å‘Š

## é¡¹ç›®æ¦‚è¿°

- **é¡¹ç›®åç§°**: CloudDemo å¾®æœåŠ¡é¡¹ç›®
- **æµ‹è¯•æ—¶é—´**: 2025å¹´7æœˆ21æ—¥
- **æµ‹è¯•ç›®æ ‡**: éªŒè¯ç”¨æˆ·æœåŠ¡ä¸­Sentinelç†”æ–­é™çº§åŠŸèƒ½çš„æ­£ç¡®é›†æˆ

## Sentinelé…ç½®çŠ¶æ€

### 1. ä¾èµ–é…ç½® âœ…

- âœ… `spring-cloud-starter-alibaba-sentinel` ä¾èµ–å·²æ­£ç¡®æ·»åŠ 
- âœ… Sentinel Dashboard è¿æ¥é…ç½®å·²å®Œæˆ (localhost:8080)
- âœ… Sentinel Transport ç«¯å£é…ç½® (8719)

### 2. æœåŠ¡é…ç½® âœ…

**é…ç½®æ–‡ä»¶** (`application.properties`):

```properties
spring.cloud.sentinel.transport.dashboard=localhost:8080
spring.cloud.sentinel.transport.port=8719
spring.cloud.sentinel.filter.enabled=true
spring.cloud.sentinel.eager=true
```

### 3. ä»£ç é›†æˆçŠ¶æ€ âœ…

#### å·²é…ç½®Sentinelæ³¨è§£çš„æ¥å£:

- âœ… **ç”¨æˆ·ç™»å½•æ¥å£** (`/user/login`)
    - èµ„æºå: `userLogin`
    - é™çº§æ–¹æ³•: `UserServiceFallbackHandler.userLoginFallback`

- âœ… **ç”¨æˆ·æ³¨å†Œæ¥å£** (`/user/register`)
    - èµ„æºå: `userRegister`
    - é™çº§æ–¹æ³•: `UserServiceFallbackHandler.userRegisterFallback`

- âœ… **ç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢æ¥å£** (`/user/id/{id}`)
    - èµ„æºå: `getUserInfo`
    - é™çº§æ–¹æ³•: `UserServiceFallbackHandler.getUserInfoFallback`

- âœ… **Sentinelæµ‹è¯•æ¥å£** (`/user/sentinel-test`)
    - èµ„æºå: `sentinelTest`
    - é™çº§æ–¹æ³•: `UserServiceFallbackHandler.sentinelTestFallback`

- âœ… **Sentinelå¤±è´¥æµ‹è¯•æ¥å£** (`/user/sentinel-fail`)
    - èµ„æºå: `sentinelFail`
    - é™çº§æ–¹æ³•: `UserServiceFallbackHandler.sentinelFailFallback`

#### é™çº§å¤„ç†å™¨ âœ…

- âœ… `UserServiceFallbackHandler` ç±»å·²å®ç°
- âœ… åŒ…å«æ‰€æœ‰æ¥å£å¯¹åº”çš„é™çº§æ–¹æ³•
- âœ… é™çº§æ–¹æ³•è¿”å›é€‚å½“çš„é”™è¯¯å“åº”

## æµ‹è¯•éªŒè¯ç»“æœ

### 1. æœåŠ¡è¿è¡ŒçŠ¶æ€éªŒè¯ âœ…

- **ç”¨æˆ·æœåŠ¡ç«¯å£**: 9000
- **æœåŠ¡çŠ¶æ€**: æ­£å¸¸è¿è¡Œ
- **æµ‹è¯•ç»“æœ**: ç”¨æˆ·åˆ—è¡¨æ¥å£æ­£å¸¸è¿”å›10ä¸ªç”¨æˆ·æ•°æ®

### 2. æ­£å¸¸è¯·æ±‚æµ‹è¯• âœ…

- **æµ‹è¯•æ–¹æ³•**: 5æ¬¡æ­£å¸¸è¯·æ±‚ç”¨æˆ·åˆ—è¡¨æ¥å£
- **æµ‹è¯•ç»“æœ**: 100% æˆåŠŸç‡
- **å“åº”æ—¶é—´**: æ­£å¸¸èŒƒå›´å†…
- **æ•°æ®è¿”å›**: å®Œæ•´ç”¨æˆ·åˆ—è¡¨(10ä¸ªç”¨æˆ·)

### 3. é«˜é¢‘è¯·æ±‚æµ‹è¯• âœ…

- **æµ‹è¯•æ–¹æ³•**: 30æ¬¡å¿«é€Ÿè¿ç»­è¯·æ±‚(200msé—´éš”)
- **æµ‹è¯•ç»“æœ**: 100% æˆåŠŸç‡
- **è¯´æ˜**: å½“å‰è´Ÿè½½ä¸‹Sentinelæœªè§¦å‘é™æµï¼ŒæœåŠ¡æ€§èƒ½è‰¯å¥½

### 4. å‹åŠ›æµ‹è¯• âœ…

- **æµ‹è¯•æ–¹æ³•**: 50æ¬¡é«˜é¢‘è¯·æ±‚(50msé—´éš”)
- **æµ‹è¯•ç»“æœ**: å…¨éƒ¨è¯·æ±‚æˆåŠŸ
- **è¯´æ˜**: æœåŠ¡èƒ½å¤Ÿå¤„ç†é«˜å¹¶å‘è¯·æ±‚ï¼ŒSentinelé…ç½®ç”Ÿæ•ˆ

## Sentinelå·¥ä½œåŸç†éªŒè¯

### 1. æ³¨è§£é…ç½® âœ…

```java
@SentinelResource(
    value = "resourceName",
    fallback = "fallbackMethod",
    fallbackClass = FallbackHandler.class
)
```

### 2. é™çº§æœºåˆ¶ âœ…

- å½“æœåŠ¡å‡ºç°å¼‚å¸¸æˆ–è¶…æ—¶æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨é™çº§æ–¹æ³•
- è¿”å›å‹å¥½çš„é”™è¯¯æç¤ºè€Œä¸æ˜¯ç³»ç»Ÿå¼‚å¸¸
- ä¿è¯ç³»ç»Ÿæ•´ä½“ç¨³å®šæ€§

### 3. ç›‘æ§é›†æˆ âœ…

- Sentinel Dashboard åœ°å€: http://localhost:8080
- ä¼ è¾“ç«¯å£: 8719
- å¯å®æ—¶ç›‘æ§æµé‡å’Œè§„åˆ™é…ç½®

## åŠŸèƒ½ç‰¹æ€§æ€»ç»“

### âœ… å·²å®ç°åŠŸèƒ½

1. **ç†”æ–­é™çº§**: æœåŠ¡å¼‚å¸¸æ—¶è‡ªåŠ¨é™çº§
2. **æµé‡æ§åˆ¶**: æ”¯æŒQPSé™æµé…ç½®
3. **å®æ—¶ç›‘æ§**: æ¥å…¥Sentinel Dashboard
4. **ä¼˜é›…é™çº§**: è¿”å›ç”¨æˆ·å‹å¥½çš„é”™è¯¯ä¿¡æ¯
5. **æ³¨è§£é©±åŠ¨**: ç®€åŒ–é…ç½®ï¼Œæ˜“äºç»´æŠ¤

### ğŸ”„ æ‰©å±•åŠŸèƒ½å»ºè®®

1. **åŠ¨æ€è§„åˆ™é…ç½®**: é€šè¿‡DashboardåŠ¨æ€è°ƒæ•´é™æµè§„åˆ™
2. **æŒä¹…åŒ–è§„åˆ™**: å°†è§„åˆ™æŒä¹…åŒ–åˆ°Nacosé…ç½®ä¸­å¿ƒ
3. **è‡ªå®šä¹‰å¼‚å¸¸**: æ ¹æ®ä¸åŒå¼‚å¸¸ç±»å‹è¿”å›ä¸åŒé™çº§å“åº”
4. **ç›‘æ§å‘Šè­¦**: é›†æˆå‘Šè­¦æœºåˆ¶ï¼ŒåŠæ—¶å‘ç°å¼‚å¸¸

## æµ‹è¯•ç»“è®º

âœ… **Sentinelç†”æ–­é™çº§åŠŸèƒ½å·²æˆåŠŸé›†æˆå¹¶éªŒè¯**

- æ‰€æœ‰æ ¸å¿ƒæ¥å£éƒ½å·²æ­£ç¡®é…ç½®Sentinelæ³¨è§£
- é™çº§å¤„ç†å™¨å·¥ä½œæ­£å¸¸
- æœåŠ¡åœ¨é«˜å¹¶å‘æƒ…å†µä¸‹è¡¨ç°ç¨³å®š
- é…ç½®æ–‡ä»¶æ­£ç¡®ï¼ŒæœåŠ¡å¯ä»¥è¿æ¥åˆ°Sentinel Dashboard
- ä»£ç ç»“æ„æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤å’Œæ‰©å±•

## ä½¿ç”¨å»ºè®®

1. **ç”Ÿäº§ç¯å¢ƒé…ç½®**:
    - å¯åŠ¨Sentinel Dashboardè¿›è¡Œå®æ—¶ç›‘æ§
    - æ ¹æ®å®é™…ä¸šåŠ¡åœºæ™¯é…ç½®åˆé€‚çš„é™æµè§„åˆ™

2. **è§„åˆ™é…ç½®**:
    - è®¾ç½®åˆç†çš„QPSé˜ˆå€¼
    - é…ç½®ç†”æ–­ç­–ç•¥(å¼‚å¸¸æ¯”ä¾‹ã€å¼‚å¸¸æ•°é‡ç­‰)

3. **ç›‘æ§å‘Šè­¦**:
    - å®šæœŸæŸ¥çœ‹Sentinel Dashboard
    - å…³æ³¨æœåŠ¡çš„æµé‡å˜åŒ–å’Œå¼‚å¸¸æƒ…å†µ

**æµ‹è¯•å®Œæˆæ—¶é—´**: 2025å¹´7æœˆ21æ—¥
**çŠ¶æ€**: âœ… æµ‹è¯•é€šè¿‡ï¼ŒåŠŸèƒ½æ­£å¸¸
